@model IEnumerable<DalaWeb.Domain.Entities.Counters.CounterValues>

@{
    ViewBag.Title = "Показания счетчиков";
}

<script src="~/Scripts/jquery-1.9.1.min.js"></script>
<script src="~/Scripts/jquery-1.9.1.js"></script>
<script>
    $(document).ready(function () {
        $("#ServiceName").change(function () {
            var selected = $(this).find('option:selected').text();
            if (selected != "Все")
            {
                var tableSelector = "#infobody";
                var $table = $(tableSelector);
                $table.find("tr").hide().filter(function () { return $.trim($(this).find("td:nth-child(4)").text()) == selected; }).show();
            }
            else
            {
                var tableSelector = "#infobody";
                var $table = $(tableSelector);
                $table.find("tr").show();
            }
        });
    });
</script>

<h2>Главная</h2>
@Html.ActionLink("Импортировать показания", "Create")

<p>
    <b>Фильтровать счетчики</b> @Html.DropDownList("ServiceName", (SelectList)ViewBag.ServiceName)
</p>
@if(Model.Any())
{ 
<table>
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Counter.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Value)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Date)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Counter.Service.Name)
        </th>
        <th></th>
    </tr>
    <tbody id="infobody">
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.Counter.Name)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Value)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Date)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Counter.Service.Name)
                </td>
            </tr>
        }
    </tbody>
</table>
}
